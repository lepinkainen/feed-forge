<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/">
  <title>{{.FeedTitle}}</title>
  <link href="{{.FeedLink}}"/>
  <id>{{.FeedID}}</id>
  <updated>{{.Updated}}</updated>
  <author><name>{{.FeedAuthor}}</name></author>
  <subtitle>{{.FeedDescription}}</subtitle>
  <generator uri="https://github.com/lepinkainen/feed-forge">{{.Generator}}</generator>

{{range .Items}}
  <entry>
    <title>{{.Title | xmlEscape}}</title>
    <link rel="alternate" type="text/html" href="{{.CommentsLink | xmlEscape}}"/>
    {{if ne .Link .CommentsLink}}<link rel="related" type="text/html" href="{{.Link | xmlEscape}}" title="Article"/>{{end}}
    <id>{{.ID | xmlEscape}}</id>
    <updated>{{.Updated}}</updated>
    <published>{{.Published}}</published>
    <author>
      <name>{{.Author | xmlEscape}}</name>
      <uri>https://news.ycombinator.com/user?id={{.Author | xmlEscape}}</uri>
    </author>
    {{range .Categories}}<category term="{{. | xmlEscape}}" label="{{. | xmlEscape}}"/>{{end}}
    <category term="points:{{.Score}}" label="Points: {{.Score}}" scheme="hackernews-metadata"/>
    <category term="comments:{{.Comments}}" label="Comments: {{.Comments}}" scheme="hackernews-metadata"/>
    {{if .Domain}}<category term="domain:{{.Domain | xmlEscape}}" label="Domain: {{.Domain | xmlEscape}}" scheme="hackernews-metadata"/>{{end}}

    <content type="html"><![CDATA[
      <div class="metadata">
        <p><strong>Score:</strong> {{.Score}} | <strong>Comments:</strong> {{.Comments}}</p>
      </div>
      {{if index $.OpenGraphData .Link}}
        {{$og := index $.OpenGraphData .Link}}
        <div class="link-preview">
          <h3>ðŸ”— Link Preview</h3>
          {{if $og.Image}}<img src="{{$og.Image | xmlEscape}}" alt="Preview image" style="max-width: 200px; height: auto;"/>{{end}}
          {{if $og.Title}}<h4>{{$og.Title | xmlEscape}}</h4>{{end}}
          {{if $og.Description}}<p>{{$og.Description | xmlEscape}}</p>{{end}}
          {{if $og.SiteName}}<p><em>Source: {{$og.SiteName | xmlEscape}}</em></p>{{end}}
        </div>
      {{end}}
      <div class="links">
        {{if ne .Link .CommentsLink}}
          <p><a href="{{.Link | xmlEscape}}">View External Link</a> | <a href="{{.CommentsLink | xmlEscape}}">View Comments</a></p>
        {{else}}
          <p><a href="{{.CommentsLink | xmlEscape}}">View Comments</a></p>
        {{end}}
      </div>
    ]]></content>

    <summary>{{.Summary | xmlEscape}}</summary>

    {{if index $.OpenGraphData .Link}}
      {{$og := index $.OpenGraphData .Link}}
      {{if $og.Image}}<link rel="enclosure" type="image/jpeg" href="{{$og.Image | xmlEscape}}"/>{{end}}
      {{if $og.Image}}<media:thumbnail url="{{$og.Image | xmlEscape}}"/>{{end}}
    {{end}}
  </entry>
{{end}}
</feed>